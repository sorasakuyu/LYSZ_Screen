<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Kaguya-Loading</title>
	<style>
		body { margin: 0; display: grid; place-items: center; min-height: 100vh; font-family: Arial, sans-serif; color: #333; }
	</style>
</head>
<body>
	<p>Loadingâ€¦</p>
	<script>
		(async () => {
			let redirected = false;
			const controller = new AbortController();
			const timeoutId = setTimeout(() => {
				redirected = true;
				controller.abort();
				window.location.replace('/error.html');
			}, 5000);

			try {
				const res = await fetch('http://0.0.0.0:9000/config/', { mode: 'cors', signal: controller.signal });
				if (!res.ok) throw new Error('Failed to load config');
				const data = await res.json();
				if (redirected) return;
				clearTimeout(timeoutId);
				if (data && data.mode === 'default') {
					window.location.replace('/default.html');
				}
                else if (data && data.mode === 'video') {
					window.location.replace('/video.html');
				}
			} catch (err) {
				if (redirected) return;
				clearTimeout(timeoutId);
				console.error('Config fetch error:', err);
				window.location.replace('/error.html');
			}
		})();
	</script>
</body>
</html>
